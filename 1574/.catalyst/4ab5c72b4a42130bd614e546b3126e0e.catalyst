{"title":{"en":"F. Occurrences","ru":"F. Вхождения"},"contestId":"1574","problemIndex":"F","timeLimit":{"en":"7 seconds","ru":"7 секунд"},"memLimit":{"en":"512 megabytes","ru":"512 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p>A subarray of array $$$a$$$ from index $$$l$$$ to the index $$$r$$$ is the array $$$[a_l, a_{l+1}, \\dots, a_{r}]$$$. The number of occurrences of the array $$$b$$$ in the array $$$a$$$ is the number of subarrays of $$$a$$$ such that they are equal to $$$b$$$.</p><p>You are given $$$n$$$ arrays $$$A_1, A_2, \\dots, A_n$$$; the elements of these arrays are integers from $$$1$$$ to $$$k$$$. You have to build an array $$$a$$$ consisting of $$$m$$$ integers from $$$1$$$ to $$$k$$$ in such a way that, for <span class=\"tex-font-style-bf\">every</span> given subarray $$$A_i$$$, the number of occurrences of $$$A_i$$$ in the array $$$a$$$ is <span class=\"tex-font-style-bf\">not less</span> than the number of occurrences of each non-empty subarray of $$$A_i$$$ in $$$a$$$. Note that if $$$A_i$$$ doesn't occur in $$$a$$$, and no subarray of $$$A_i$$$ occurs in $$$a$$$, this condition is still met for $$$A_i$$$.</p><p>Your task is to calculate the number of different arrays $$$a$$$ you can build, and print it modulo $$$998244353$$$.</p>","ru":"<p>Подмассив массива $$$a$$$ с индекса $$$l$$$ по индекс $$$r$$$ — это массив $$$[a_l, a_{l+1}, \\dots, a_{r}]$$$. Количество вхождений массива $$$b$$$ в массива $$$a$$$ — это количество таких подмассивов массива $$$a$$$, которые равны $$$b$$$.</p><p>Вам даны $$$n$$$ массивов $$$A_1, A_2, \\dots, A_n$$$; их элементы — целые числа от $$$1$$$ до $$$k$$$. Вы должны построить массив $$$a$$$ из $$$m$$$ целых чисел от $$$1$$$ до $$$k$$$ таким образом, чтобы <span class=\"tex-font-style-bf\">для каждого</span> заданного массива $$$A_i$$$ выполнялось следующее условие: количество вхождений массива $$$A_i$$$ в массив $$$a$$$ <span class=\"tex-font-style-bf\">не меньше</span>, чем количество вхождений каждого непустого подмассива $$$A_i$$$ в $$$a$$$ (по отдельности). Обратите внимание, что если $$$A_i$$$ не входит в $$$a$$$, и никакой подмассив $$$A_i$$$ не входит в $$$a$$$, это условие выполняется для $$$A_i$$$.</p><p>Ваша задача — посчитать количество различных массивов $$$a$$$, удовлетворяющих этим условиям, и вывести его по модулю $$$998244353$$$.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line contains three integers $$$n$$$, $$$m$$$ and $$$k$$$ ($$$1 \\le n, m, k \\le 3 \\cdot 10^5$$$) — the number of the given arrays, the desired length of the array $$$a$$$, and the upper bound on the values in the arrays.</p><p>Then $$$n$$$ lines follow. The $$$i$$$-th line represents the array $$$A_i$$$. The first integer in the $$$i$$$-th line is $$$c_i$$$ ($$$1 \\le c_i \\le m$$$) — the number of elements in $$$A_i$$$; then, $$$c_i$$$ integers from $$$1$$$ to $$$k$$$ follow — the elements of the array $$$A_i$$$.</p><p>Additional constraint on the input: $$$\\sum\\limits_{i=1}^n c_i \\le 3 \\cdot 10^5$$$; i. e., the number of elements in the given arrays in total does not exceed $$$3 \\cdot 10^5$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>В первой строке заданы три целых числа $$$n$$$, $$$m$$$ и $$$k$$$ ($$$1 \\le n, m, k \\le 3 \\cdot 10^5$$$) — количество заданных массивов, требуемое количество элементов в массиве $$$a$$$, и верхнее ограничение на элементы массивов.</p><p>Затем следуют $$$n$$$ строк. $$$i$$$-я строка задает массив $$$A_i$$$. Первое число в $$$i$$$-й строке — $$$c_i$$$ ($$$1 \\le c_i \\le m$$$), количество элементов в массиве $$$A_i$$$; затем следуют $$$c_i$$$ целых чисел от $$$1$$$ до $$$k$$$ — элементы массива $$$A_i$$$.</p><p>Дополнительное ограничение на входные данные: $$$\\sum\\limits_{i=1}^n c_i \\le 3 \\cdot 10^5$$$; то есть общее количество элементов в заданных массивах не превосходит $$$3 \\cdot 10^5$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>Print one integer — the number of different arrays $$$a$$$ you can build, taken modulo $$$998244353$$$.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>Выведите одно целое число — количество различных массивов $$$a$$$, удовлетворяющих данным условиям, по модулю $$$998244353$$$.</p>"},"noteHtml":{"en":null,"ru":null},"sampleTestcases":[{"id":1659345218117,"input":"2 4 3\n2 1 2\n1 3\n","output":"5\n"},{"id":1659345218118,"input":"2 4 3\n2 1 2\n3 3 2 1\n","output":"0\n"},{"id":1659345218119,"input":"1 42 1337\n2 13 31\n","output":"721234447\n"}],"submitUrl":"https://codeforces.com/contest/1574/submit","language":"python"}